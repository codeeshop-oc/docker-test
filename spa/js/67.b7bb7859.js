(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[67],{"8e27":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"q-account-settings"}},[a("TopHeader"),a("div",{staticClass:"container px-0 main-content"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-lg-3 col-sm-4 col-12"},[a("SideNavProfile")],1),a("div",{staticClass:"col-lg-9 col-sm-8 col-12"},[a("div",{staticClass:"ui-block"},[t._m(0),a("div",{staticClass:"ui-block-content p-4"},[a("div",{staticClass:"text-h5 q-mb-md"},[t._v("Select a Security Method")]),a("div",{staticClass:"row q-px-md"},[a("div",{staticClass:"col-sm-6 col-12"},[a("div",{staticClass:"text-h6"},[t._v(" Text Message (SMS)")]),a("div",{staticClass:"text-span"},[t._v("Use text message (SMS) to receive verification codes. For your protection, phone numbers used for two-factor authentication can't be used to reset your password when two-factor is on.")]),a("div",{staticClass:"q-mt-md"},[a("div",{staticClass:"togglebutton",on:{click:function(){t.two_factor_auth.text_message?(t.textmsg_dlg=!1,t.openDialog=!0,t.currDialogKey="text_message"):(t.textmsg_dlg=!0,t.openDialog=!1,t.currDialogKey="")}}},[a("label",{staticClass:"c-pointer ps-none",on:{change:function(e){t.text_message=!t.text_message}}},[a("input",{attrs:{type:"checkbox"},domProps:{checked:t.text_message}}),a("span",{staticClass:"toggle"})])])])]),a("div",{staticClass:"col-sm-6 col-12"},[a("div",{staticClass:"text-h6"},[t._v(" Authentication App")]),a("div",{staticClass:"text-span"},[t._v("Use an app like Google Authenticator or Duo Mobile to generate verification codes for more protection.")]),a("div",{staticClass:"q-mt-lg q-pt-md",staticStyle:{"margin-top":"28px"}},[a("div",{staticClass:"togglebutton",on:{click:t.getAuthenticateApp}},[a("label",{staticClass:"c-pointer ps-none",on:{change:function(e){t.authentication_app=!t.authentication_app}}},[a("input",{attrs:{type:"checkbox"},domProps:{checked:t.authentication_app}}),a("span",{staticClass:"toggle"})])])])])])])])])])]),a("q-dialog",{attrs:{persistent:""},model:{value:t.authapp_dlg,callback:function(e){t.authapp_dlg=e},expression:"authapp_dlg"}},[a("q-card",{staticClass:"q-px-lg q-py-md",staticStyle:{"min-width":"500px"}},[a("div",{staticClass:"row q-px-md"},[a("div",{staticClass:"text-h6"},[t._v("Authentication App")]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",icon:"close"},on:{click:function(e){return t.userDetails()}}})],1),a("hr"),a("q-card-section",{staticClass:"q-px-none"},[t.two_factor_auth.authentication_app?t._e():a("div",{staticClass:"text-center row"},[a("div",{staticClass:"col col-12"},[a("span",{staticClass:"d-inline-block",staticStyle:{padding:"10px",width:"175px",height:"175px","background-color":"#000"}},[a("q-img",{attrs:{src:t.qr_code,ratio:"1",height:"155px",width:"155px"}})],1)]),a("h1",{staticClass:"m-auto q-my-sm"},[t._v("OR")]),a("div",{staticClass:"text-h5 col col-12"},[a("div",[t._v(t._s(t.secret_key?t.secret_key:"---- ---- ---- ----"))])])])]),t.two_factor_auth.authentication_app?t._e():a("div",[a("div",{staticClass:"form-group label-floating"},[a("label",{staticClass:"control-label"},[t._v("Enter OTP")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.authapp_otp,expression:"authapp_otp"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.authapp_otp},on:{input:function(e){e.target.composing||(t.authapp_otp=e.target.value)}}}),a("span",{staticClass:"material-input"})]),a("q-card-actions",{staticClass:"q-gutter-sm",attrs:{align:"right"}},[a("button",{staticClass:"btn btn-primary",on:{click:function(e){return t.checkAuthApp()}}},[t._v("Continue")])])],1)],1)],1),a("q-dialog",{attrs:{persistent:""},model:{value:t.textmsg_dlg,callback:function(e){t.textmsg_dlg=e},expression:"textmsg_dlg"}},[a("q-card",{staticClass:"q-px-lg q-py-md",staticStyle:{"min-width":"500px"}},[a("div",{staticClass:"row q-px-md"},[a("div",{staticClass:"text-h6"},[t._v("Text Message (SMS)")]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",icon:"close"},on:{click:function(e){return t.userDetails()}}})],1),a("hr"),a("q-card-section",{staticClass:"q-px-none q-pt-none"},[t.otp_received?a("div",[a("div",{staticClass:"q-mb-md text-span"},[t._v("Please Enter your OTP to enable Two factor Authentiction")]),a("div",{staticClass:"description-toggle"},[a("div",{staticClass:"form-group label-floating"},[a("label",{staticClass:"control-label"},[t._v("Enter OTP")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.authapp_otp,expression:"authapp_otp"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.authapp_otp},on:{input:function(e){e.target.composing||(t.authapp_otp=e.target.value)}}}),a("span",{staticClass:"material-input"})])]),a("button",{staticClass:"btn btn-primary float-right rev-btn rev-btn-text",on:{click:function(e){return t.checkAuthAppTextMsg()}}},[t._v("\n            Save\n          ")])]):a("div",{staticClass:"description-toggle"},[a("div",{staticClass:"description-toggle-content"},[a("div",{staticClass:"h6"},[t._v("Enable/Disable Two-factor authentication ")]),a("span",{staticClass:"text-span"},[t._v("Use text message (SMS) to receive verification codes.")])])])]),t.otp_received?t._e():a("q-card-actions",{staticClass:"q-gutter-sm",attrs:{align:"right"}},[a("button",{staticClass:"btn btn-primary rev-btn rev-btn-text",on:{click:function(e){return t.sendOTP()}}},[t._v("\n          "+t._s(1==t.two_factor_auth.text_message?"Save":"Get Started")+"\n        ")])])],1)],1),a("SureDialog",{attrs:{openDialog:t.openDialog},on:{"update:value":function(e){return t.openDialogRes(e)}}})],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ui-block-title"},[a("h6",{staticClass:"title"},[t._v("Two Factor Authentication")])])}],o=a("2f62"),c=a("57e1"),n=a("2aee"),r=a("1412"),l={name:"TwoFactorAuthentication",data(){return{currDialogKey:"",openDialog:!1,authentication_app:!1,text_message:!1,two_factor_auth:{text_message:!1,authentication_app:!1},textmsg_dlg:!1,authapp_dlg:!1,qr_code:"",secret_key:"",otp_received:!1,authapp_otp:""}},components:{SideNavProfile:n["a"],SureDialog:r["a"],TopHeader:c["a"]},mounted(){this.userDetails()},methods:{...Object(o["b"])("user",["getProfileInfo","userActions","authenticateApp","checkAuthenticateApp","accountSetting"]),...Object(o["b"])("auth",["verifyMobileTwoAuth","resendOTP"]),openDialogRes(t){t?(this.two_factor_auth[this.currDialogKey]=!1,this.enableTwoFactorAuth(1)):this.userDetails(),this.openDialog=!1},changeCheck(t,e){1==t.target.checked?"text_message"==e&&(this.textmsg_dlg=!0):(this.currDialogKey=e,this.openDialog=!0)},checkAuthApp(){this.two_factor_auth.authentication_app||(this.authapp_dlg=!0,this.checkAuthenticateApp({secret_key:this.secret_key,otp:this.authapp_otp}).then((t=>{this.$revfunc.notification(t.message),t.status&&(this.two_factor_auth.authentication_app=!0,this.authapp_otp="",this.secret_key="")})).catch((t=>{})))},getAuthenticateApp(){this.two_factor_auth.authentication_app?(this.authapp_dlg=!1,this.openDialog=!0,this.currDialogKey="authentication_app"):(this.openDialog=!1,this.currDialogKey="",this.authapp_dlg=!0,this.authenticateApp().then((t=>{t.status&&(this.qr_code=t.qr_code,this.secret_key=t.secret_key)})).catch((t=>{})))},userDetails(){this.getProfileInfo({user_id:this.$q.localStorage.getItem("rev_user").userId}).then((t=>{t.status&&(this.two_factor_auth=Object.assign(this.two_factor_auth,JSON.parse(t.results.user.two_factor_auth)),this.text_message=this.two_factor_auth.text_message,this.authentication_app=this.two_factor_auth.authentication_app)})).catch((t=>{}))},sendOTP(){this.two_factor_auth.text_message||this.resendOTP({two_auth_otp:1,user_id:this.$q.localStorage.getItem("rev_user").userId}).then((t=>{t.status&&(this.otp_received=!0),this.$revfunc.notification(t.message,{actions:[{icon:"close",color:"white"}]})})).catch((t=>{}))},checkAuthAppTextMsg(){this.loading=!0,this.verifyMobileTwoAuth({otp:this.authapp_otp}).then((t=>{this.$revfunc.notification(t.message),this.loading=!1,t.status&&(this.otp_received=!1,this.two_factor_auth.text_message=!0,this.text_message=!0,this.authapp_otp="",this.textmsg_dlg=!1)})).catch((t=>{}))},enableTwoFactorAuth(t=0){let e={two_factor_auth:JSON.stringify({text_message:this.two_factor_auth.text_message,authentication_app:this.two_factor_auth.authentication_app})};this.loading=!0,t?this.accountSetting(e).then((t=>{this.loading=!1,this.$revfunc.notification(t.message),this.userDetails()})).catch((t=>{})):this.userDetails()}}},p=l,h=a("2877"),u=a("24e8"),_=a("f09f"),d=a("2c91"),g=a("9c40"),v=a("a370"),m=a("068f"),f=a("4b7e"),x=a("7f67"),C=a("eebe"),b=a.n(C),w=Object(h["a"])(p,s,i,!1,null,"04647a9e",null);e["default"]=w.exports;b()(w,"components",{QDialog:u["a"],QCard:_["a"],QSpace:d["a"],QBtn:g["a"],QCardSection:v["a"],QImg:m["a"],QCardActions:f["a"]}),b()(w,"directives",{ClosePopup:x["a"]})}}]);