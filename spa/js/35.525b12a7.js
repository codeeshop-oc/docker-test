(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[35],{8299:function(e,t,a){"use strict";a("be75")},be75:function(e,t,a){},e8930:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"q-notification"}},[a("q-ajax-bar",{ref:"bar",staticClass:"bg-rev",attrs:{position:"top",size:"5px","skip-hijack":""}}),a("TopHeader"),null!=e.user?a("div",{staticClass:"container px-0 main-content"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col col-xl-9 order-xl-2 col-lg-9 order-lg-2 col-md-12 order-md-1 col-sm-12 col-12"},[a("div",{staticClass:"ui-block"},[e._m(0),a("div",{staticClass:"ui-block-content p-4"},[a("q-form",{staticClass:"content"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col col-sm-6 col-6"},[a("div",{staticClass:"form-group label-floating"},[a("label",{staticClass:"control-label"},[e._v("Display Name")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.user.profile_name,expression:"user.profile_name"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.user.profile_name},on:{input:function(t){t.target.composing||e.$set(e.user,"profile_name",t.target.value)}}}),a("span",{staticClass:"material-input"})]),a("div",{},[a("h6",{staticClass:"q-mb-lg"},[e._v("Font Size")]),a("q-slider",{attrs:{min:12,max:20,step:1,label:"","label-always":"",color:"primary"},on:{change:function(t){return this.$revfunc.setCss("--font-size",e.user.appearance.font_size+"px")}},model:{value:e.user.appearance.font_size,callback:function(t){e.$set(e.user.appearance,"font_size",t)},expression:"user.appearance.font_size"}})],1)]),a("div",{staticClass:"col col-lg-2 col-md-3 col-12"},[a("h6",[e._v("Badge")]),"none"!=e.user.badge?a("img",{staticClass:"q-py-md",attrs:{src:"img/badges/"+e.user.badge+".png"}}):a("div",[e._v("No Badge")])]),a("div",{staticClass:"col col-md-2col-sm-4 text-right"},[a("a",{staticClass:"author-thumb relative-position"},[a("img",{staticClass:"rounded m-auto",staticStyle:{width:"100%",height:"100%"},attrs:{src:e.user.profile_img&&"logo.png"!=e.user.profile_img?e.$revfunc.uploadPath()+"user"+e.user.userId+"/images/"+e.user.profile_img:e.$revfunc.baseurl()+"assets/images/logo.png",alt:"author"}}),a("q-input",{ref:"fileprofileinput",staticClass:"file-input",attrs:{type:"file",accept:e.IMAGE_ACCEPT,name:""},on:{input:function(t){e.file=t[0]},change:function(t){return e.canvasImage("profile_img")}}}),a("a",{staticClass:"float-btn q-pa-xs",on:{click:function(t){return e.$refs.fileprofileinput.$el.click()}}},[a("img",{staticClass:"icon-rev-xs",attrs:{src:"/img/icons/primary/common/profilecamera.png"}})])],1)])]),a("div",{staticClass:"row q-mt-md"},[a("div",{staticClass:"col col-lg-6 col-md-6 col-sm-12 col-12"},[a("h6",[e._v("Bio")]),a("div",{staticClass:"form-group"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.user.biography,expression:"user.biography"}],staticClass:"form-control",attrs:{maxlength:e.BIO_LIMIT,placeholder:"Write a little description about you"},domProps:{value:e.user.biography},on:{input:function(t){t.target.composing||e.$set(e.user,"biography",t.target.value)}}},[e._v(e._s(e.user.biography))]),a("div",{staticClass:"text-right"},[e._v(e._s(e.user.biography.length)+"/"+e._s(e.BIO_LIMIT))]),a("span",{staticClass:"material-input"})])]),a("div",{staticClass:"col col-lg-3 col-md-3 col-sm-12 col-12"},[a("h6",[e._v("Bio Visibilty")]),a("q-option-group",{attrs:{options:e.bio_visi_options,type:"radio",color:"primary"},model:{value:e.user.bio_visibilty,callback:function(t){e.$set(e.user,"bio_visibilty",t)},expression:"user.bio_visibilty"}})],1),a("div",{staticClass:"col col-lg-3 col-md-3 col-12"},[a("h6",[e._v("Appearance")]),a("q-option-group",{attrs:{options:e.appearance_options,type:"radio",color:"primary"},on:{input:function(t){return e.setTheme(e.user.appearance.theme)}},model:{value:e.user.appearance.theme,callback:function(t){e.$set(e.user.appearance,"theme",t)},expression:"user.appearance.theme"}})],1)]),a("div",{staticClass:"row q-mt-md"},[a("div",{staticClass:"col col-lg-12 col-md-12 col-12"},[a("h6",[e._v("Background Theme")]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-3",on:{click:function(t){e.user.appearance.bg_theme="",e.setBGTheme("")}}},[a("div",{staticClass:"blank-div bb-rev-rounded col-12 q-mr-md q-img overflow-hidden",staticStyle:{border:"1px solid #000",cursor:"pointer",width:"180px",height:"60px"},style:""==e.user.appearance.bg_theme?"box-shadow: 0 0 5px 2px #000;":""})]),e._l(e.bg_themes,(function(t,s){return a("div",{key:s,staticClass:"q-mb-sm col-3"},[a("q-img",{staticClass:"bb-rev-rounded col-12 q-mr-md",style:e.user.appearance.bg_theme==t?"box-shadow: 0 0 7px 4px #000;cursor: pointer;":"cursor: pointer;",attrs:{width:"180px",height:"60px",src:e.$revfunc.uploadPath()+"bg_images/"+t},on:{click:function(a){e.user.appearance.bg_theme=t,e.setBGTheme(t)}}})],1)}))],2)])]),a("div",{staticClass:"row q-mt-md"},[a("div",{staticClass:"col col-md-12 col-sm-12 col-12"},[a("h6",[e._v("Cover Photo")]),a("img",{staticClass:"rounded",staticStyle:{width:"100%"},attrs:{src:"cover.png"!=this.user.cover_img?e.$revfunc.uploadPath()+"user"+e.user.userId+"/images/"+this.user.cover_img:this.$revfunc.baseurl()+"assets/images/cover-default-potrait.jpg",alt:"author"}}),a("q-input",{ref:"filecoverinput",staticClass:"file-input",attrs:{type:"file",name:""},on:{input:function(t){e.file=t[0]},change:function(t){return e.canvasImage("cover_img")}}}),a("a",{staticClass:"float-btn cover q-px-xs q-pt-xs",on:{click:function(t){return e.$refs.filecoverinput.$el.click()}}},[a("img",{staticClass:"icon-rev-xs",attrs:{src:"/img/icons/primary/common/profilecamera.png"}})])],1)]),a("div",{staticClass:"row q-mt-xl"},[a("div",{staticClass:"text-center col col-6"},[a("button",{staticClass:"btn btn-lg w-100 rev-btn rev-btn-text",attrs:{type:"button",flat:""},on:{click:function(t){return e.onSubmit()}}},[e.loading?a("span",[a("i",{staticClass:"fa-2x fas fa-spinner fa-spin"})]):a("div",[e._v("Save all Changes")])])]),a("div",{staticClass:"text-center col col-6"},[a("button",{staticClass:"btn btn-lg w-100 rev-btn rev-btn-text",attrs:{type:"button",flat:""},on:{click:function(){e.dlg_deactivate=!0}}},[e._v("\n                    Cancel Changes\n                  ")])])])])],1)])]),a("div",{staticClass:"col col-xl-3 order-xl-1 col-lg-3 order-lg-1 col-md-12 order-md-2 col-sm-12 col-12 responsive-display-none"},[a("SideNavProfile")],1)])]):e._e(),a("q-dialog",{attrs:{persistent:"",maximized:"","transition-show":"slide-up","transition-hide":"slide-down"},model:{value:e.crop_image_bool,callback:function(t){e.crop_image_bool=t},expression:"crop_image_bool"}},[a("q-card",{staticClass:"q-pa-md"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",icon:"close"}}),a("button",{staticClass:"text-capitalize btn-primary btn-md full-width",attrs:{type:"button",align:"center"},on:{click:function(t){return e.saveCanvas()}}},[e._v("Save\n          "),a("i",{staticClass:"fas fa-save"})]),a("cropper",{attrs:{"stencil-props":e.ratio,src:e.crop_image},on:{change:e.change}})],1)],1)],1)},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ui-block-title"},[a("h6",{staticClass:"title"},[e._v("Profile Settings")])])}],r=(a("ddb0"),a("2b3d"),a("9861"),a("2b0e")),o=a("2f62"),l=a("57e1"),n=a("2aee"),c=a("5289"),p=a("1760"),u=a("8716"),h=a("a2c1"),m=(a("f7aa"),{name:"ProfileSettings",mixins:[p["a"]],data(){return{BIO_LIMIT:u["a"],IMAGE_ACCEPT:u["d"],initUserData:{},crop_image:"",canvas:!1,crop_bg_image_bool:!1,crop_image_bool:!1,loading:!1,user:null,biography:null,all_countries:[],all_states:[],bio_visi_options:[{label:"All",value:"all"},{label:"Followers Only",value:"followers"},{label:"Following Only",value:"following"},{label:"Followers & Following",value:"both"}],appearance_options:[{label:"Dark Mode",value:"dark"},{label:"Light Mode",value:"light"},{label:"Dim mode",value:"dim"}],bg_themes:[],ratio:{aspectRatio:1}}},watch:{country(e,t){null!=t&&(this.state=""),this.all_states=[];let a=c["a"].findIndex((t=>t.countryName==e));if(a>=0){let e=c["a"][a].regions;for(let t=e.length-1;t>=0;t--)this.all_states.push(e[t].name);this.all_states.reverse()}},"user.biography"(e){e&&this.textAreaHeight()}},components:{TopHeader:l["a"],SideNavProfile:n["a"],Cropper:h["a"]},mounted(){this.userDetails()},methods:{...Object(o["b"])("user",["uploadImages","getProfileInfo","updateProfileInfo"]),...Object(o["d"])("user",["UPDATE_USER"]),...Object(o["b"])("config",["backgroundTheme"]),textAreaHeight(){r["a"].nextTick((()=>{this.$refs.textarea&&(this.$refs.textarea.style.height="",this.$refs.textarea.style.height=this.$refs.textarea.scrollHeight+"px")}))},getBgImages(){this.backgroundTheme().then((e=>{e.status&&(this.allbackgrounds=e.results)})).catch((e=>{}))},change({coordinates:e,canvas:t}){this.canvas=t},userDetails(){this.loading=!0,this.$refs.bar.start(),this.getProfileInfo({user_id:this.$q.localStorage.getItem("rev_user").userId}).then((e=>{if(this.$refs.bar.stop(),e.status){for(let e=c["a"].length-1;e>=0;e--)this.all_countries.push(c["a"][e].countryName);this.all_countries.reverse(),this.user=e.results.user,this.UPDATE_USER(Object.assign({},this.user)),this.user.appearance=JSON.parse(e.results.user.appearance),this.bg_themes=e.results.user.bg_images}this.initUserData=this.prepareData(),this.loading=!1})).catch((e=>{}))},async readGraphic(e){try{return new Promise(((t,a)=>{let s=URL.createObjectURL(e),i=new Image;i.addEventListener("load",(function(e){t(i),URL.revokeObjectURL(s)}),!1),this.crop_image=s,this.crop_image_bool=!0}))}catch(t){logger("warn",t,"readGraphic err")}},canvasImage(e){"cover_img"==e&&(this.ratio.aspectRatio=32/9),this.image_column=e,this.readGraphic(this.file)},saveCanvas(){this.canvas&&this.canvas.toBlob((e=>{const t=new FormData;t.append(this.image_column,e),this.uploadImages(t).then((e=>{e.status&&e.results&&(this.user=this.results),this.crop_image_bool=!1,this.canvas=!1,this.userDetails()})).catch((e=>{this.crop_image_bool=!1,this.canvas=!1}))}),"image/jpeg")},prepareData(){return{profile_name:this.user.profile_name,biography:this.user.biography,bio_visibilty:this.user.bio_visibilty,appearance:JSON.stringify({theme:this.user.appearance.theme,font_size:this.user.appearance.font_size,bg_theme:this.user.appearance.bg_theme})}},onSubmit(){this.loading=!0;let e=this.prepareData();this.updateProfileInfo(e).then((e=>{this.loading=!1,this.$revfunc.notification(e.message),this.initUserData=this.prepareData()})).catch((e=>{}))}},beforeRouteLeave(e,t,a){if(JSON.stringify(this.initUserData)!==JSON.stringify(this.prepareData())){const e=window.confirm("Do you really want to leave? You have unsaved changes!\nPress Ok to save them or Cancel to Leave");e&&this.onSubmit()}return a()},async beforeDestroy(){await this.getProfileInfo({user_id:this.$q.localStorage.getItem("rev_user").userId}).then((e=>{e.status&&(this.user=e.results.user,this.UPDATE_USER(Object.assign({},this.user)),this.user.appearance=JSON.parse(e.results.user.appearance),this.$revfunc.setCss("--font-size",this.user.appearance.font_size+"px"),this.setBGTheme(this.user.appearance.bg_theme),this.setTheme(this.user.appearance.theme)),this.loading=!1})).catch((e=>{}))}}),d=m,g=(a("8299"),a("2877")),v=a("7ea5"),f=a("0378"),b=a("c1d0"),_=a("27f9"),C=a("9f0a"),x=a("068f"),y=a("24e8"),w=a("f09f"),I=a("9c40"),k=a("7f67"),q=a("eebe"),$=a.n(q),S=Object(g["a"])(d,s,i,!1,null,"82e38672",null);t["default"]=S.exports;$()(S,"components",{QAjaxBar:v["a"],QForm:f["a"],QSlider:b["a"],QInput:_["a"],QOptionGroup:C["a"],QImg:x["a"],QDialog:y["a"],QCard:w["a"],QBtn:I["a"]}),$()(S,"directives",{ClosePopup:k["a"]})}}]);